<!doctype html><html lang="en"><head><title>Estimating the Weights of Biased Coins - Jim Killingsworth</title><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="description" content="Suppose we flip a coin four times. If the coin lands on heads, we win a dollar. If the coin lands on tails, we lose a dollar. After four tosses of the coin, the best possible outcome is a winning total of four dollars. The worst possible outcome is a loss of four dollars. Let’s assume the coin is a biased coin. Furthermore, let’s also assume a different biased coin is used on each flip depending on the total amount won or lost since the beginning of the game. How can we determine the bias of each coin given a probability mass function of the expected outcome?"/><base href="/"/><link rel="canonical" href="https://jkillingsworth.com/2019/09/14/estimating-the-weights-of-biased-coins/"/><link rel="icon" href="./static/favicon.ico" type="image/x-icon"/><link rel="icon" href="./static/favicon-256.jpg" sizes="256x256"/><link rel="preload" href="./static/fonts/open-sans-v20-latin-700.woff2" as="font" crossorigin/><link rel="preload" href="./static/fonts/lora-v17-latin-regular.woff2" as="font" crossorigin/><link rel="preload" href="./static/fonts/lora-v17-latin-italic.woff2" as="font" crossorigin/><link rel="preload" href="./static/fonts/roboto-mono-v13-latin-regular.woff2" as="font" crossorigin/><link rel="preload" href="https://www.google-analytics.com/analytics.js" as="script"/><script src="https://www.googletagmanager.com/gtag/js?id=UA-114299226-1" async></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag() { dataLayer.push(arguments); }
  gtag("js", new Date());
  gtag("config", "UA-114299226-1", { "send_page_view": true });
</script><style>@font-face{font-display:swap;font-family:"Open Sans";font-style:normal;font-weight:700;src:local("Open Sans Bold"),local("OpenSans-Bold"),url(./static/fonts/open-sans-v20-latin-700.woff2) format("woff2"),url(./static/fonts/open-sans-v20-latin-700.woff) format("woff")}@font-face{font-display:swap;font-family:"Lora";font-style:normal;font-weight:400;src:local("Lora Regular"),local("Lora-Regular"),url(./static/fonts/lora-v17-latin-regular.woff2) format("woff2"),url(./static/fonts/lora-v17-latin-regular.woff) format("woff")}@font-face{font-display:swap;font-family:"Lora";font-style:italic;font-weight:400;src:local("Lora Italic"),local("Lora-Italic"),url(./static/fonts/lora-v17-latin-italic.woff2) format("woff2"),url(./static/fonts/lora-v17-latin-italic.woff) format("woff")}@font-face{font-display:swap;font-family:"Roboto Mono";font-style:normal;font-weight:400;src:local("Roboto Mono"),local("RobotoMono-Regular"),url(./static/fonts/roboto-mono-v13-latin-regular.woff2) format("woff2"),url(./static/fonts/roboto-mono-v13-latin-regular.woff) format("woff")}
/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}main{display:block}h1{font-size:2em;margin:0.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace, monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace, monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-0.25em}sup{top:-0.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}button,[type="button"],[type="reset"],[type="submit"]{-webkit-appearance:button}button::-moz-focus-inner,[type="button"]::-moz-focus-inner,[type="reset"]::-moz-focus-inner,[type="submit"]::-moz-focus-inner{border-style:none;padding:0}button:-moz-focusring,[type="button"]:-moz-focusring,[type="reset"]:-moz-focusring,[type="submit"]:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:0.35em 0.75em 0.625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type="checkbox"],[type="radio"]{box-sizing:border-box;padding:0}[type="number"]::-webkit-inner-spin-button,[type="number"]::-webkit-outer-spin-button{height:auto}[type="search"]{-webkit-appearance:textfield;outline-offset:-2px}[type="search"]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}template{display:none}[hidden]{display:none}
html{box-sizing:border-box;overflow-y:scroll}*,*::before,*::after{box-sizing:inherit}body{font-family:"Lora", "Georgia", serif;font-weight:normal;background:#fff;color:#000;display:flex;flex-flow:row wrap;font-size:12pt;justify-content:space-between;line-height:1.5;margin:0 auto;width:90%}body>*{flex:0 100%}body>header{font-size:21pt;margin:10px 0}body>footer{border-top:3px solid gray;font-size:10pt;font-style:italic;padding:16px 0}header,nav,h1,h2{font-family:"Open Sans", "Verdana", sans-serif;font-weight:bold}header a,nav a,h1 a,h2 a{color:inherit}a{color:blue;text-decoration:none}a:hover{color:blue;text-decoration:underline}strong{font-family:"Open Sans", "Verdana", sans-serif;font-weight:bold}svg{fill:currentColor}.navmenu{border-top:3px solid gray;border-bottom:1px solid #ccc}.navmenu #toggle{float:right;height:24px;margin:4px 0;width:24px}.navmenu #toggle+label{color:transparent;cursor:pointer;display:block;padding:4px 0;position:relative;user-select:none;-moz-user-select:none;-ms-user-select:none;-webkit-user-select:none}.navmenu #toggle+label::before{background:#fff;background-size:24px;content:"";float:right;height:24px;left:24px;position:relative;width:24px}.navmenu #toggle+label::after{content:"Menu";left:0;padding:0 16px;position:absolute}.navmenu #toggle+label{border-bottom:none}.navmenu #toggle+label::before{background-image:url("./static/chevron-down.svg")}.navmenu #toggle+label::after{color:#000}.navmenu #toggle~ul{height:0;visibility:hidden}.navmenu #toggle:checked+label{border-bottom:1px solid #e6e6e6}.navmenu #toggle:checked+label::before{background-image:url("./static/chevron-up.svg")}.navmenu #toggle:checked+label::after{color:gray}.navmenu #toggle:checked~ul{height:auto;visibility:visible}.navmenu ul{display:flex;flex-flow:column wrap;list-style-type:none;justify-content:flex-start;margin:0;overflow:hidden;padding:0}.navmenu ul>li{flex:none}.navmenu ul>li a{display:block;padding:4px 16px}.navmenu ul>li a:hover,.navmenu ul>li a:focus{background:gray;color:#fff}.content{max-width:720px}.content header,.content footer,.content h1,.content h2,.content p,.content ul,.content figure{margin:24px 0}.content h1{font-size:18pt}.content h2{font-size:12pt}.content footer{font-style:italic}.content p:last-of-type::after{clear:both;content:"";display:block}.content ul{padding-left:16px}.content ul>li{margin:12px 0}.content figure{max-width:90vw}.content figure>img{display:block}.content .fig-chart{padding-top:56.25%;page-break-inside:avoid;position:relative}.content .fig-chart>img{max-height:100%;max-width:100%;position:absolute;top:0}.content .fig-latex{overflow-x:auto}.content .fig-latex>img{margin:0 16px}.content .fig-pic-l>img,.content .fig-pic-r>img{margin:0 auto;max-width:100%;object-fit:cover}.content .button{font-family:"Open Sans", "Verdana", sans-serif;font-weight:bold;background:#e6e6e6;color:inherit;display:block;margin:24px 0;padding:4px 0;text-align:center}.content .button:hover,.content .button:focus{background:gray;color:#fff}.content .message header>h1{background:#ff0;display:inline-block;font-size:12pt;margin:0;text-transform:lowercase}.content .message header>h1::first-letter{text-transform:uppercase}.content .message header>h1::after{content:":"}.content .message p{font-style:italic}.content .newpost header>h1{background:#ff0;display:inline-block;font-size:12pt;margin:0;text-transform:lowercase}.content .newpost header>h1::first-letter{text-transform:uppercase}.content .newpost header>h1::after{content:":"}.content .newpost header>h2{font-size:18pt}.content .newpost a.readmore::after{content:" \00bb"}.content .newpost a:not(.readmore):not(:hover){color:inherit}.content .oldpost{margin:24px 0}.content .oldpost header>h1{display:none}.content .archive ul>li time{font-family:"Roboto Mono", "Consolas", "Menlo", monospace;font-weight:normal;display:none;font-size:10pt}.content .contact label,.content .contact input[type="submit"]{font-family:"Open Sans", "Verdana", sans-serif;font-weight:bold;cursor:pointer;display:block;margin:16px 0}.content .contact label{margin-bottom:4px}.content .contact input[type="text"],.content .contact input[type="email"],.content .contact textarea{font-family:"Roboto Mono", "Consolas", "Menlo", monospace;font-weight:normal;display:block;font-size:10pt;line-height:inherit;padding:4px;width:100%}.content .contact textarea{height:200px;max-width:100%;min-width:100%}.content .contact input[type="submit"]{padding:4px 40px}.content .comments{margin:24px 0 8px}.content .comments header>h2{display:none}.content .comments noscript{font-family:"Roboto Mono", "Consolas", "Menlo", monospace;font-weight:normal;display:block;font-size:10pt;margin:-12px 0 24px}.sidebar header>h1{display:none}.sidebar header>h2{border-bottom:1px solid #ccc;border-top:3px solid gray;font-size:inherit;margin:0;padding:4px 0}.sidebar section{margin:24px 0}.sidebar section:first-of-type{margin-top:0}.sidebar .social-media ul{list-style:none;padding:0 0 0 16px}.sidebar .social-media ul>li a{display:inline-block}.sidebar .social-media ul>li a *{vertical-align:middle}.sidebar .social-media ul>li a span{margin:0 10px}.sidebar .social-media ul>li a svg{color:gray;height:48px;width:48px}.sidebar .social-media ul>li a:hover svg{color:inherit}.content p:not(.nojustify),.sidebar p:not(.nojustify){text-align:justify;word-spacing:-1px}.content p,.content ul,.sidebar p,.sidebar ul{line-height:1.667}@media only screen and (min-width: 600px){.content ul{padding-left:40px}.content ul>li{margin:0}.content figure{max-width:90vw}.content .fig-latex>img{margin:0 40px}.content .fig-pic-l>img{float:left;margin:0 24px 0 0}.content .fig-pic-r>img{float:right;margin:0 0 0 24px}.content .archive ul>li time{display:inline}body{max-width:720px;width:90%}body>header{font-size:24pt}.navmenu #toggle{display:none}.navmenu #toggle+label{display:none}.navmenu #toggle~ul{height:auto;visibility:visible}.navmenu ul{flex-flow:row wrap}.navmenu ul>li a{padding:4px 32px}}@media only screen and (min-width: 1200px){body{max-width:1200px}body>header{text-align:center}.content{flex:0 60%}.sidebar{flex:0 35%}.sidebar section:first-of-type{margin-top:40px}}@media only print{.content ul{padding-left:40px}.content ul>li{margin:0}.content figure{max-width:100vw}.content .fig-latex>img{margin:0 40px}.content .fig-pic-l>img{float:left;margin:0 24px 0 0}.content .fig-pic-r>img{float:right;margin:0 0 0 24px}.content .archive ul>li time{display:inline}body{display:block;margin:auto;width:100%}body>header{border-bottom:1px solid #ccc;border-top:3px solid gray;font-size:inherit;margin:0;padding:4px 0;text-align:left}.navmenu,.sidebar,.oldpost,.comments{display:none}}@page{margin:1in 1.25in}
</style></head><body><header><a href="./">Jim Killingsworth</a></header><nav class="navmenu"><input id="toggle" type="checkbox"/><label for="toggle">Enable menu</label><ul><li><a href="./"> Home </a></li><li><a href="./archive/"> Archive </a></li><li><a href="./about/"> About </a></li><li><a href="./contact/"> Contact </a></li></ul></nav><main class="content"><article><header><h1>Estimating the Weights of Biased Coins</h1></header><p>Sup­pose we flip a coin four times. If the coin lands on heads, we win a dol­lar. If the coin lands on tails, we lose a dol­lar. After four tosses of the coin, the best pos­si­ble out­come is a win­ning total of four dol­lars. The worst pos­si­ble out­come is a loss of four dol­lars. Let’s assume the coin is a biased coin. Fur­ther­more, let’s also assume a dif­fer­ent biased coin is used on each flip depend­ing on the total amount won or lost since the begin­ning of the game. How can we deter­mine the bias of each coin given a prob­a­bil­ity mass func­tion of the expected out­come?</p><p>In this post, I want to explore a tech­nique that can be used to answer this ques­tion. I am hop­ing this model can be expanded to give some bet­ter insights into obser­va­tions made in my pre­vi­ous posts regard­ing the <a href="/2019/01/26/the-distribution-of-price-fluctuations/">dis­tri­b­u­tion of price fluctuations</a> and the <a href="/2019/02/10/the-very-strange-chinese-yuan/">strange behav­ior of the Chi­nese yuan</a>.</p><h2 id="markov-model">Markov Model</h2><p>The afore­men­tioned coin toss game can be mod­eled as a Markov chain. The game starts in the ini­tial zero state. Each toss of the coin deter­mines whether the sys­tem tran­si­tions to a higher state or a lower state. If the coin lands on heads, we move to a higher state. If the coin lands on tails, we move to a lower state. Each state deter­mines the weight of the biased coin used in the next toss. Here is a graph­i­cal rep­re­sen­ta­tion of the Markov model:</p><figure class="fig-latex"><img width="547" height="388" alt="Figure 1" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-01-latex-2249743300.svg"></figure><p>In this mod­el, the coin in the zero state is always a fair coin. A fair coin will land on heads 50% of the time and tails 50% of the time. Addi­tion­al­ly, this model is also sym­met­ri­cal. The biased coins in the neg­a­tive states are weighted inversely to the biased coins in the cor­re­spond­ing pos­i­tive states. The dia­gram above can alter­nately be depicted as follows:</p><figure class="fig-latex"><img width="499" height="267" alt="Figure 2" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-02-latex-3879999744.svg"></figure><p>Note that the pos­i­tive and neg­a­tive fourth states can only be ter­mi­nal states, so there is never a tran­si­tion out of them. Also keep in mind that the Markov model does not nec­es­sar­ily have to be sym­met­ri­cal. I chose to make it sym­met­ri­cal to reduce the num­ber of vari­ables and sim­plify the model.</p><h2 id="monte-carlo-simulation">Monte Carlo Simulation</h2><p>If we know the weights of the biased coins, we can use a Monte Carlo sim­u­la­tion to esti­mate the expected out­come of the coin toss game. Sim­ply put, we can run a mil­lion sim­u­lated rounds of the coin toss game, with four flips in each round, and observe the dis­tri­b­u­tion of pos­si­ble out­comes. Sup­pose each coin is weighted fairly:</p><figure class="fig-latex"><img width="63" height="97" alt="Figure 3" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-03-latex-1179348411.svg"></figure><p>The val­ues above can be pre­sented visu­ally on a chart like this:</p><figure class="fig-chart" style="padding-top: 56.25%;"><img width="720" height="405" alt="Figure 4" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-04-binomial-equal-biases.svg"></figure><p>In the Monte Carlo sim­u­la­tion, we use a ran­dom num­ber gen­er­a­tor to sim­u­late the out­come of each coin toss. We record the ter­mi­nal state after each round of four coin toss­es. After run­ning one mil­lion rounds of the coin toss game, the dis­tri­b­u­tion of ter­mi­nal states looks like this:</p><figure class="fig-chart" style="padding-top: 56.25%;"><img width="720" height="405" alt="Figure 5" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-05-binomial-equal-pmfunc-simulated.svg"></figure><p>This gives us an esti­mate of the expected out­come after four tosses of the coin. Notice that only even ter­mi­nal states are pos­si­ble when there is an even num­ber of coin toss­es. Odd num­bered ter­mi­nal states would only be pos­si­ble if there were an odd num­ber of toss­es. It is also worth not­ing that the chart above closely approx­i­mates a bino­mial dis­tri­b­u­tion. Here is a break­down of the expec­ta­tion for each indi­vid­ual coin toss sequence:</p><figure class="fig-chart" style="padding-top: 56.25%;"><img width="720" height="405" alt="Figure 6" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-06-binomial-equal-tosses-simulated.svg"></figure><p>The val­ues are all roughly the same, indi­cat­ing that all pos­si­ble coin toss sequences have about an equal prob­a­bil­ity of being observed in any given round of the coin toss game, assum­ing we’re always using fair coins. The Monte Carlo sim­u­la­tion is a brute force approach that yields fairly accu­rate results. We can arrive at more pre­cise val­ues by solv­ing analytically.</p><h2 id="analytical-evaluation">Analytical Evaluation</h2><p>With four tosses of the coin, there are six­teen pos­si­ble coin toss sequences and five unique ter­mi­nal states. The fol­low­ing ta­ble lists every pos­si­ble coin toss sequence along with its ter­mi­nal state and a for­mula for the prob­a­bil­ity of each combination:</p><figure class="fig-latex"><img width="499" height="563" alt="Figure 7" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-07-latex-1567852246.svg"></figure><p>Keep in mind that the model is sym­met­ri­cal. Let’s use the fol­low­ing nota­tion to rep­re­sent prob­a­bil­ity of land­ing on each of the five pos­si­ble ter­mi­nal states:</p><figure class="fig-latex"><img width="158" height="106" alt="Figure 8" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-08-latex-3188257379.svg"></figure><p>Since the model is sym­met­ri­cal, the chance of end­ing up on any given pos­i­tive ter­mi­nal state is equal to the prob­a­bil­ity of end­ing up on the cor­re­spond­ing neg­a­tive ter­mi­nal state. The equa­tions above can be rewrit­ten as follows:</p><figure class="fig-latex"><img width="470" height="158" alt="Figure 9" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-09-latex-1144904775.svg"></figure><p>Plug­ging in the prob­a­bil­ity for­mula for each of the coin toss com­bi­na­tions, the equa­tions above can be expressed like this:</p><figure class="fig-latex"><img width="501" height="132" alt="Figure 10" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-10-latex-1422914935.svg"></figure><p>By def­i­n­i­tion, since our model is a sym­met­ri­cal one, we know that the coin used in the zero state is always a fair coin:</p><figure class="fig-latex"><img width="63" height="18" alt="Figure 11" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-11-latex-1714859298.svg"></figure><p>Sub­sti­tut­ing the value above for the weight of the coin at the zero state and then sim­pli­fy­ing, we can arrive at the fol­low­ing set of equations:</p><figure class="fig-latex"><img width="297" height="136" alt="Figure 12" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-12-latex-4081775235.svg"></figure><p>This set of equa­tions rep­re­sents the rela­tion­ship between the weights of the biased coins and the expected out­come of the coin toss game. If we know the weights of the coins, we can com­pute the prob­a­bil­ity mass func­tion of the expected out­come after four tosses of the coin. To illus­trate, let’s assume each coin is weighted fairly:</p><figure class="fig-latex"><img width="63" height="71" alt="Figure 13" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-13-latex-0353046682.svg"></figure><p>This is the same sce­nario we started with when doing the Monte Carlo sim­u­la­tion above, so we can expect to get the same or sim­i­lar results. Plug­ging in the num­bers, here are the com­puted results:</p><figure class="fig-latex"><img width="89" height="71" alt="Figure 14" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-14-latex-3791477472.svg"></figure><p>These results can be pre­sented visu­ally with the fol­low­ing chart:</p><figure class="fig-chart" style="padding-top: 56.25%;"><img width="720" height="405" alt="Figure 15" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-15-binomial-equal-pmfunc-evaluated.svg"></figure><p>These are the exact fig­ures that were esti­mated by the Monte Carlo sim­u­la­tion demon­strated in the pre­vi­ous sec­tion. This is a bino­mial dis­tri­b­u­tion. The com­puted expec­ta­tion of each indi­vid­ual coin toss sequence is show below:</p><figure class="fig-chart" style="padding-top: 56.25%;"><img width="720" height="405" alt="Figure 16" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-16-binomial-equal-tosses-evaluated.svg"></figure><p>This con­firms the result esti­mated by the Monte Carlo sim­u­la­tion as well. When always using a fair coin, each of the six­teen com­bi­na­tions of coin toss sequences has an equal prob­a­bil­ity of being observed.</p><h2 id="many-possible-solutions">Many Possible Solutions</h2><p>We know from the pre­vi­ous sec­tions that if all the coins are fairly weight­ed, then the expected out­come after four coin tosses is a bino­mial dis­tri­b­u­tion. But what if we start with a bino­mial dis­tri­b­u­tion as the expected out­come and work back­wards to find the weights of the coins? We already know that hav­ing fairly weighted coins is one pos­si­ble solu­tion. But can there be other pos­si­ble solu­tions as well?</p><p>Let’s intro­duce the fol­low­ing nota­tion. We have seen a graph­i­cal illus­tra­tion of what a bino­mial dis­tri­b­u­tion looks like in the pre­vi­ous sec­tion. Here is the sym­bolic form of the prob­a­bil­ity mass func­tion for a bino­mial dis­tri­b­u­tion:</p><figure class="fig-latex"><img width="309" height="112" alt="Figure 17" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-17-latex-0201685828.svg"></figure><p>For suc­cinct­ness, I am using an alter­nate zero based index to rep­re­sent the ter­mi­nal states. The fol­low­ing rela­tion­ship holds:</p><figure class="fig-latex"><img width="232" height="19" alt="Figure 18" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-18-latex-1406921003.svg"></figure><p>Since there are only four coin tosses in the model we’re using here, we can substitute:</p><figure class="fig-latex"><img width="42" height="14" alt="Figure 19" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-19-latex-0078029047.svg"></figure><p>Now recall the fol­low­ing from the pre­vi­ous section:</p><figure class="fig-latex"><img width="158" height="106" alt="Figure 20" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-20-latex-3188257379.svg"></figure><p>We can sub­sti­tute the alter­nate nota­tion and rewrite it like this:</p><figure class="fig-latex"><img width="194" height="106" alt="Figure 21" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-21-latex-1165049530.svg"></figure><p>Plug­ging in the num­bers and doing the math, we can com­pute the fol­low­ing val­ues to rep­re­sent the bino­mial distribution:</p><figure class="fig-latex"><img width="89" height="71" alt="Figure 22" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-22-latex-3791477472.svg"></figure><p>This rep­re­sents the expected out­come after four coin toss­es. Now we want to fig­ure out what weights of the biased coins will give us this expec­ta­tion. Based on the analy­sis in the pre­vi­ous sec­tion, we already know that play­ing the coin toss game with fairly weighted coins will give us our desired result:</p><figure class="fig-latex"><img width="63" height="71" alt="Figure 23" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-23-latex-0353046682.svg"></figure><p>How­ev­er, this is not the only solu­tion. As it turns out, there is an entire range of pos­si­ble solu­tions that result in an expected out­come that takes the form of a bino­mial dis­tri­b­u­tion. Con­sider the fol­low­ing equa­tions derived in the pre­vi­ous section:</p><figure class="fig-latex"><img width="297" height="136" alt="Figure 24" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-24-latex-4081775235.svg"></figure><p>Any solu­tion that fits these equa­tions is a valid solu­tion pro­vided that the fol­low­ing con­straints are met:</p><figure class="fig-latex"><img width="271" height="19" alt="Figure 25" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-25-latex-3926295537.svg"></figure><p>The con­straints are nec­es­sary because a coin can­not land on heads less than 0% of the time, nor can it land on heads more than 100% of the time. Using the equa­tions above, we can rearrange them and solve for the weights of the biased coins in the +2 and +3 states in terms of the weight of the coin in the +1 state:</p><figure class="fig-latex"><img width="129" height="109" alt="Figure 26" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-26-latex-2653587590.svg"></figure><p>Any value for the weight of the biased coin in the +1 state can be used pro­vided that the afore­men­tioned con­straints are met for the weights of all coins. There is a range of pos­si­ble val­ues for the coin in the +1 state. This range has a lower and upper bound. We can deter­mine the lower bound for the weight of the coin in the +1 state by set­ting the weight of the coin in the +2 state to the max­i­mum value of one:</p><figure class="fig-latex"><img width="49" height="17" alt="Figure 27" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-27-latex-1741834887.svg"></figure><p>With the weights of the coin in the +2 state held con­stant at one, we can solve for the weights of the coins in the +1 and + 3 states:</p><figure class="fig-latex"><img width="101" height="89" alt="Figure 28" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-28-latex-0671641082.svg"></figure><p>Plug­ging the val­ues into the equations:</p><figure class="fig-latex"><img width="92" height="71" alt="Figure 29" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-29-latex-0560594235.svg"></figure><p>Here are the weights of all the coins when the weight of the coin in the +1 state is at the lower bound of the range:</p><figure class="fig-chart" style="padding-top: 56.25%;"><img width="720" height="405" alt="Figure 30" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-30-binomial-lower-biases.svg"></figure><p>Using the above weights, we can eval­u­ate the expected out­come of the coin toss game and show that it indeed does result in a bino­mial distribution:</p><figure class="fig-chart" style="padding-top: 56.25%;"><img width="720" height="405" alt="Figure 31" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-31-binomial-lower-pmfunc-evaluated.svg"></figure><p>This is the same expected out­come we would get if all the coins were fair coins. How­ev­er, con­sider the expec­ta­tion of each indi­vid­ual coin toss sequence:</p><figure class="fig-chart" style="padding-top: 56.25%;"><img width="720" height="405" alt="Figure 32" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-32-binomial-lower-tosses-evaluated.svg"></figure><p>Not all coin toss com­bi­na­tions are equal. Some have a higher prob­a­bil­ity of being observed than oth­ers when the biased coins are weighted unfair­ly. We can observe a sim­i­lar phe­nom­enon when the weights of the coins are at the oppo­site extreme of the range of pos­si­ble val­ues. Sup­pose the weight of the coin in the +3 state is set to the max­i­mum value of one:</p><figure class="fig-latex"><img width="49" height="18" alt="Figure 33" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-33-latex-2604362758.svg"></figure><p>With this held con­stant, we can find the upper bound for the weight of the coin in the +1 state and the low­est value for the weight of the coin in the +2 state:</p><figure class="fig-latex"><img width="136" height="110" alt="Figure 34" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-34-latex-2641159734.svg"></figure><p>Plug­ging the val­ues into the equations:</p><figure class="fig-latex"><img width="92" height="71" alt="Figure 35" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-35-latex-0680290385.svg"></figure><p>Here are the weights of all the coins when the weight of the coin in the +1 state is at the upper bound of the range:</p><figure class="fig-chart" style="padding-top: 56.25%;"><img width="720" height="405" alt="Figure 36" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-36-binomial-upper-biases.svg"></figure><p>Again, using the above weights, we can eval­u­ate the expected out­come of the coin toss game and show that it indeed does result in a bino­mial distribution:</p><figure class="fig-chart" style="padding-top: 56.25%;"><img width="720" height="405" alt="Figure 37" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-37-binomial-upper-pmfunc-evaluated.svg"></figure><p>Like before, this is the same expected out­come we would get if all the coins were fair coins. But in this case, we get a dif­fer­ent set of expec­ta­tions for each coin toss sequence:</p><figure class="fig-chart" style="padding-top: 56.25%;"><img width="720" height="405" alt="Figure 38" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-38-binomial-upper-tosses-evaluated.svg"></figure><p>The exam­ples illus­trated in this sec­tion demon­strate two extremes of a range of pos­si­ble val­ues for the weights of biased coins. In both exam­ples, these val­ues yield an expected out­come in the shape of a bino­mial dis­tri­b­u­tion when play­ing the coin toss game with four toss­es. And this is the same out­come we can expect when play­ing the game with fair coins. Of course, there are many other pos­si­ble val­ues that will give us a bino­mial dis­tri­b­u­tion as well.</p><h2 id="hill-climbing-algorithm">Hill Climbing Algorithm</h2><p>What if the expected out­come is not a bino­mial dis­tri­b­u­tion? Sup­pose we observe many rounds of the coin toss game and deter­mine the expected out­come is a tri­an­gle dis­tri­b­u­tion instead. We know the coins are biased, but how can we esti­mate the weights of the biased coins? Con­sider the sym­bolic form of a tri­an­gle dis­tri­b­u­tion:</p><figure class="fig-latex"><img width="309" height="90" alt="Figure 39" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-39-latex-3991061183.svg"></figure><p>Using the tech­niques described in the pre­vi­ous sec­tion, we can com­pute the fol­low­ing val­ues for the tri­an­gle distribution:</p><figure class="fig-latex"><img width="89" height="71" alt="Figure 40" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-40-latex-2905051351.svg"></figure><p>We can also rep­re­sent this visu­ally with the fol­low­ing chart:</p><figure class="fig-chart" style="padding-top: 56.25%;"><img width="720" height="405" alt="Figure 41" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-41-triangle-learn-pmfunc.svg"></figure><p>And using the tech­niques described in the pre­vi­ous sec­tion, we can also com­pute the lower and upper bounds of the range of pos­si­ble val­ues that will yield a tri­an­gle dis­tri­b­u­tion. The val­ues are illus­trated below:</p><figure class="fig-chart" style="padding-top: 56.25%;"><img width="720" height="405" alt="Figure 42" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-42-triangle-learn-biases-lower.svg"></figure><figure class="fig-chart" style="padding-top: 56.25%;"><img width="720" height="405" alt="Figure 43" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-43-triangle-learn-biases-upper.svg"></figure><p>While the weights illus­trated above are valid to pro­duce a tri­an­gle dis­tri­b­u­tion, they might not be the best esti­mates to model a real world sce­nar­io. A coin that always lands on heads or always lands on tails, for exam­ple, might not be the most accu­rate model of real­i­ty. It might be bet­ter to come up with an inter­me­di­ate solu­tion that lies some­where in between the two extremes.</p><p>Instead of try­ing to find an inter­me­di­ate solu­tion ana­lyt­i­cal­ly, we can try to find one incre­men­tal­ly. We can start with an ini­tial guess some­where in the mid­dle and then incre­men­tally try to improve our ini­tial esti­mate. We can repeat this process until we con­verge on a valid solu­tion that fits the tri­an­gle dis­tri­b­u­tion. This would effec­tively be a type of hill climb­ing algorithm.</p><p>Sup­pose we start with an ini­tial guess of all fairly weighted coins. We can ran­domly pick one of the esti­mated weights, adjust it up or down by a small amount, and then mea­sure whether or not the adjust­ment brings the com­puted out­come closer to that of a tri­an­gle dis­tri­b­u­tion. If the adjust­ment is an improve­ment, then we accept it. If the adjust­ment is not an improve­ment, then we reject it and revert back to the pre­vi­ous val­ue. We can repeat this process many times. Here is an illus­tra­tion of this algorithm:</p><figure class="fig-latex"><img width="473" height="1539" alt="Figure 44" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-44-latex-1630360193.svg"></figure><p>This algo­rithm iter­ates one mil­lion times, accept­ing or reject­ing a pro­posed incre­ment to one of the esti­mated weights. It’s basi­cally a trial and error process. Apply­ing this algo­rithm gives us the fol­low­ing esti­mates for the weights of the biased coins:</p><figure class="fig-chart" style="padding-top: 56.25%;"><img width="720" height="405" alt="Figure 45" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-45-triangle-learn-biases-estimated.svg"></figure><p>Play­ing the coin toss game with the above weights for the biased coins will yield an expected out­come that is very close to the tri­an­gle dis­tri­b­u­tion. This is not an exact solu­tion, but it is very close. This is also not the only solu­tion. One of the idio­syn­crasies of this approach is that the result can be dif­fer­ent depend­ing on what val­ues are used for the ini­tial guess. Remem­ber, there is a range of pos­si­ble solu­tions, all equally valid.</p><p>The fol­low­ing sec­tions cat­a­log the appli­ca­tion of this esti­ma­tion process to a few vari­a­tions of a dis­crete dou­ble expo­nen­tial dis­tri­b­u­tion instead of a tri­an­gle dis­tri­b­u­tion.</p><h2 id="exponential-distribution-parameter--05">Exponential Distribution, Parameter = 0.5</h2><p>Sup­pose we model the expected out­come as a dis­crete dou­ble expo­nen­tial dis­tri­b­u­tion such that the expec­ta­tion of the game fin­ish­ing on a given ter­mi­nal state is 0.5 times that of the ter­mi­nal state with the next high­est expec­ta­tion. Here is the prob­a­bil­ity mass function:</p><figure class="fig-latex"><img width="309" height="109" alt="Figure 46" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-46-latex-2008296095.svg"></figure><p>Here is a graph­i­cal rep­re­sen­ta­tion of the prob­a­bil­ity mass func­tion above:</p><figure class="fig-chart" style="padding-top: 56.25%;"><img width="720" height="405" alt="Figure 47" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-47-exponential-05-pmfunc.svg"></figure><p>The fol­low­ing charts are the lower and upper bounds of the range of pos­si­ble val­ues for weights that result in the expected out­come defined above:</p><figure class="fig-chart" style="padding-top: 56.25%;"><img width="720" height="405" alt="Figure 48" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-48-exponential-05-biases-lower.svg"></figure><figure class="fig-chart" style="padding-top: 56.25%;"><img width="720" height="405" alt="Figure 49" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-49-exponential-05-biases-upper.svg"></figure><p>Here are the esti­mated weights using the hill climb­ing algorithm:</p><figure class="fig-chart" style="padding-top: 56.25%;"><img width="720" height="405" alt="Figure 50" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-50-exponential-05-biases-estimated.svg"></figure><p>The above val­ues were esti­mated start­ing with an ini­tial guess of fairly weighted coins and run­ning the hill climb­ing algo­rithm through one mil­lion iterations.</p><h2 id="exponential-distribution-parameter--04">Exponential Distribution, Parameter = 0.4</h2><p>Sup­pose we model the expected out­come as a dis­crete dou­ble expo­nen­tial dis­tri­b­u­tion such that the expec­ta­tion of the game fin­ish­ing on a given ter­mi­nal state is 0.4 times that of the ter­mi­nal state with the next high­est expec­ta­tion. Here is the prob­a­bil­ity mass function:</p><figure class="fig-latex"><img width="309" height="109" alt="Figure 51" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-51-latex-4097567568.svg"></figure><p>Here is a graph­i­cal rep­re­sen­ta­tion of the prob­a­bil­ity mass func­tion above:</p><figure class="fig-chart" style="padding-top: 56.25%;"><img width="720" height="405" alt="Figure 52" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-52-exponential-04-pmfunc.svg"></figure><p>The fol­low­ing charts are the lower and upper bounds of the range of pos­si­ble val­ues for weights that result in the expected out­come defined above:</p><figure class="fig-chart" style="padding-top: 56.25%;"><img width="720" height="405" alt="Figure 53" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-53-exponential-04-biases-lower.svg"></figure><figure class="fig-chart" style="padding-top: 56.25%;"><img width="720" height="405" alt="Figure 54" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-54-exponential-04-biases-upper.svg"></figure><p>Here are the esti­mated weights using the hill climb­ing algorithm:</p><figure class="fig-chart" style="padding-top: 56.25%;"><img width="720" height="405" alt="Figure 55" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-55-exponential-04-biases-estimated.svg"></figure><p>The above val­ues were esti­mated start­ing with an ini­tial guess of fairly weighted coins and run­ning the hill climb­ing algo­rithm through one mil­lion iterations.</p><h2 id="exponential-distribution-parameter--03">Exponential Distribution, Parameter = 0.3</h2><p>Sup­pose we model the expected out­come as a dis­crete dou­ble expo­nen­tial dis­tri­b­u­tion such that the expec­ta­tion of the game fin­ish­ing on a given ter­mi­nal state is 0.3 times that of the ter­mi­nal state with the next high­est expec­ta­tion. Here is the prob­a­bil­ity mass function:</p><figure class="fig-latex"><img width="309" height="109" alt="Figure 56" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-56-latex-2887406741.svg"></figure><p>Here is a graph­i­cal rep­re­sen­ta­tion of the prob­a­bil­ity mass func­tion above:</p><figure class="fig-chart" style="padding-top: 56.25%;"><img width="720" height="405" alt="Figure 57" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-57-exponential-03-pmfunc.svg"></figure><p>The fol­low­ing charts are the lower and upper bounds of the range of pos­si­ble val­ues for weights that result in the expected out­come defined above:</p><figure class="fig-chart" style="padding-top: 56.25%;"><img width="720" height="405" alt="Figure 58" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-58-exponential-03-biases-lower.svg"></figure><figure class="fig-chart" style="padding-top: 56.25%;"><img width="720" height="405" alt="Figure 59" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-59-exponential-03-biases-upper.svg"></figure><p>Here are the esti­mated weights using the hill climb­ing algorithm:</p><figure class="fig-chart" style="padding-top: 56.25%;"><img width="720" height="405" alt="Figure 60" src="./2019/09/14/estimating-the-weights-of-biased-coins/fig-60-exponential-03-biases-estimated.svg"></figure><p>The above val­ues were esti­mated start­ing with an ini­tial guess of fairly weighted coins and run­ning the hill climb­ing algo­rithm through one mil­lion iterations.</p><h2 id="next-steps">Next Steps</h2><p>I want to explore this esti­ma­tion tech­nique in more depth. I would like to see what the esti­mated weights look like when the coin toss game is played with many coin tosses per round instead of just four. Per­haps this will be the topic of a later post.</p><p>Also, I would also like to come up with a more mean­ing­ful cost func­tion for the hill climb­ing algo­rithm, one that would give pref­er­ence to valid val­ues closer to the mid­dle of the range of pos­si­ble val­ues. With the imple­men­ta­tion pre­sented in this post, there is a plateau of valid val­ues that can be esti­mat­ed. The value that it con­verges to is highly depen­dent on the ini­tial guess. Hav­ing a bet­ter cost func­tion would allow the algo­rithm to con­verge to the same solu­tion regard­less of the start­ing point. I’m not sure yet how to do this.</p><p class="nojustify"><a href="https://github.com/jkillingsworth/jkillingsworth.com/tree/master/src/2019-09-14-estimating-the-weights-of-biased-coins">Accom­pa­ny­ing source code is avail­able on GitHub.</a></p><footer><time datetime="2019-09-14">September 14, 2019</time></footer></article><section class="comments"><header><h2>Comments</h2></header><script>
    var disqus_config = function () {
      this.page.url = "https://jkillingsworth.com/2019/09/14/estimating-the-weights-of-biased-coins/";
      this.page.title = "Estimating the Weights of Biased Coins";
      this.page.identifier = "/2019/09/14/estimating-the-weights-of-biased-coins/";
    };
    function disqus_show() {
      var d = document, s = d.createElement("script");
      s.src = "https://jkillingsworth.disqus.com/embed.js";
      s.setAttribute("data-timestamp", +new Date());
      (d.head || d.body).appendChild(s);
    }
    function anchor_blur() {
      var a = document.getElementById("comments");
      a.innerText = "Comments";
      a.blur();
    }
    function disqus() {
      disqus_show();
      anchor_blur();
    }
  </script><a href="javascript:disqus();" id="comments" class="button">Show comments</a><div id="disqus_thread"></div><noscript> Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript></section></main><aside class="sidebar"><header><h1>Sidebar</h1></header><section class="social-media"><header><h2>Social Media</h2></header><ul><li><a href="https://www.linkedin.com/in/jkillingsworth/"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512"><path d="M417.2 64H96.8C79.3 64 64 76.6 64 93.9V415c0 17.4 15.3 32.9 32.8 32.9h320.3c17.6 0 30.8-15.6 30.8-32.9V93.9C448 76.6 434.7 64 417.2 64zM183 384h-55V213h55v171zm-25.6-197h-.4c-17.6 0-29-13.1-29-29.5 0-16.7 11.7-29.5 29.7-29.5s29 12.7 29.4 29.5c0 16.4-11.4 29.5-29.7 29.5zM384 384h-55v-93.5c0-22.4-8-37.7-27.9-37.7-15.2 0-24.2 10.3-28.2 20.3-1.5 3.6-1.9 8.5-1.9 13.5V384h-55V213h55v23.8c8-11.4 20.5-27.8 49.6-27.8 36.1 0 63.4 23.8 63.4 75.1V384z"></path></svg><span>LinkedIn</span></a></li><li><a href="https://github.com/jkillingsworth/"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512"><path d="M256 32C132.3 32 32 134.9 32 261.7c0 101.5 64.2 187.5 153.2 217.9 1.4.3 2.6.4 3.8.4 8.3 0 11.5-6.1 11.5-11.4 0-5.5-.2-19.9-.3-39.1-8.4 1.9-15.9 2.7-22.6 2.7-43.1 0-52.9-33.5-52.9-33.5-10.2-26.5-24.9-33.6-24.9-33.6-19.5-13.7-.1-14.1 1.4-14.1h.1c22.5 2 34.3 23.8 34.3 23.8 11.2 19.6 26.2 25.1 39.6 25.1 10.5 0 20-3.4 25.6-6 2-14.8 7.8-24.9 14.2-30.7-49.7-5.8-102-25.5-102-113.5 0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8 0 0 1.6-.5 5-.5 8.1 0 26.4 3.1 56.6 24.1 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 30.2-21 48.5-24.1 56.6-24.1 3.4 0 5 .5 5 .5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6 0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5 0 30.7-.3 55.5-.3 63 0 5.4 3.1 11.5 11.4 11.5 1.2 0 2.6-.1 4-.4C415.9 449.2 480 363.1 480 261.7 480 134.9 379.7 32 256 32z"></path></svg><span>GitHub</span></a></li></ul></section></aside><footer> &copy; 2018&ndash;2021 Jim Killingsworth. All rights reserved. </footer></body></html>